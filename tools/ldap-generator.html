<!DOCTYPE html>
<html>
<head>
	<title>LDAP Query Generator - Security Tools</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Generate LDAP queries for Active Directory enumeration - find users, groups, computers, privileged accounts, and more.">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<style>
		:root {
			--bg-primary: #fafafa;
			--bg-secondary: #fff;
			--bg-code: #18181b;
			--text-primary: #171717;
			--text-secondary: #525252;
			--text-muted: #a3a3a3;
			--border-color: #e5e5e5;
			--accent: #171717;
			--accent-hover: #404040;
			--code-text: #a1a1aa;
		}

		* { box-sizing: border-box; }

		body {
			font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
			background-color: var(--bg-primary);
			color: var(--text-primary);
			margin: 0;
			padding: 0;
			line-height: 1.6;
			-webkit-font-smoothing: antialiased;
		}

		.navbar {
			background-color: var(--bg-secondary);
			padding: 16px 0;
			border-bottom: 1px solid var(--border-color);
		}

		.navbar-brand { color: var(--text-primary) !important; font-size: 15px; font-weight: 600; }
		.nav-link { color: var(--text-secondary) !important; font-size: 14px; font-weight: 500; margin-left: 24px; }
		.nav-link:hover, .nav-link.active { color: var(--text-primary) !important; }

		.page-header {
			background: var(--bg-secondary);
			border-bottom: 1px solid var(--border-color);
			padding: 32px 0;
		}

		.page-header h1 {
			font-size: 24px;
			font-weight: 700;
			letter-spacing: -0.02em;
			margin: 0;
		}

		.page-header p {
			font-size: 14px;
			color: var(--text-secondary);
			margin: 8px 0 0 0;
		}

		.main-content { padding: 32px 0 64px; }

		.card {
			background: var(--bg-secondary);
			border: 1px solid var(--border-color);
			border-radius: 8px;
			margin-bottom: 20px;
		}

		.card-header {
			background: transparent;
			border-bottom: 1px solid var(--border-color);
			padding: 14px 20px;
			font-size: 13px;
			font-weight: 600;
			color: var(--text-primary);
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.card-header i { color: var(--text-muted); font-size: 12px; }
		.card-header[data-toggle="collapse"] { cursor: pointer; }
		.card-header .float-right { margin-left: auto; }

		.card-body { padding: 20px; }

		.section-label {
			font-size: 11px;
			font-weight: 600;
			letter-spacing: 0.05em;
			text-transform: uppercase;
			color: var(--text-muted);
			margin: 16px 0 12px 0;
		}

		.section-label:first-child { margin-top: 0; }

		.preset-btn {
			display: inline-block;
			margin: 3px;
			font-size: 12px;
			padding: 5px 10px;
			border-radius: 4px;
			border: 1px solid var(--border-color);
			background: var(--bg-secondary);
			color: var(--text-secondary);
			cursor: pointer;
			transition: all 0.15s;
			font-family: 'Inter', sans-serif;
		}

		.preset-btn:hover {
			border-color: var(--text-muted);
			color: var(--text-primary);
		}

		.preset-btn.active {
			background: var(--accent);
			border-color: var(--accent);
			color: #fff;
		}

		.form-group label {
			font-size: 13px;
			font-weight: 500;
			color: var(--text-primary);
			margin-bottom: 6px;
		}

		.form-control {
			font-family: 'Inter', sans-serif;
			font-size: 13px;
			border: 1px solid var(--border-color);
			border-radius: 6px;
			padding: 8px 12px;
			transition: border-color 0.15s;
		}

		.form-control:focus {
			border-color: var(--text-muted);
			box-shadow: none;
			outline: none;
		}

		.btn-primary {
			background: var(--accent);
			border: none;
			padding: 8px 16px;
			font-size: 13px;
			font-weight: 500;
			border-radius: 6px;
		}

		.btn-primary:hover { background: var(--accent-hover); }

		.btn-secondary {
			background: var(--bg-primary);
			border: 1px solid var(--border-color);
			color: var(--text-primary);
			padding: 6px 12px;
			font-size: 12px;
			font-weight: 500;
			border-radius: 6px;
		}

		.btn-secondary:hover {
			background: var(--border-color);
			border-color: var(--border-color);
			color: var(--text-primary);
		}

		.output-area {
			background: var(--bg-code);
			color: #22c55e;
			font-family: 'JetBrains Mono', monospace;
			padding: 16px;
			border-radius: 6px;
			font-size: 13px;
			white-space: pre-wrap;
			word-break: break-all;
			min-height: 80px;
			position: relative;
		}

		.output-area.ps { color: #60a5fa; }
		.output-area.tool { color: #fbbf24; }

		.copy-btn {
			position: absolute;
			top: 8px;
			right: 8px;
			background: rgba(255,255,255,0.1);
			border: none;
			color: var(--code-text);
			padding: 4px 10px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 11px;
			font-family: 'Inter', sans-serif;
		}

		.copy-btn:hover { background: rgba(255,255,255,0.15); color: #fff; }

		.nav-tabs {
			border-bottom: 1px solid var(--border-color);
		}

		.nav-tabs .nav-link {
			border: none;
			border-bottom: 2px solid transparent;
			color: var(--text-muted) !important;
			font-size: 13px;
			font-weight: 500;
			padding: 10px 16px;
			margin: 0;
			margin-bottom: -1px;
		}

		.nav-tabs .nav-link:hover {
			border-color: transparent;
			color: var(--text-primary) !important;
		}

		.nav-tabs .nav-link.active {
			border-bottom-color: var(--accent);
			color: var(--text-primary) !important;
			background: transparent;
		}

		.tab-content {
			padding: 20px;
			border: 1px solid var(--border-color);
			border-top: none;
			border-radius: 0 0 6px 6px;
			background: var(--bg-secondary);
		}

		.ref-table {
			font-size: 12px;
			width: 100%;
		}

		.ref-table th {
			background: var(--bg-primary);
			font-weight: 600;
			padding: 8px 10px;
			border-bottom: 1px solid var(--border-color);
			color: var(--text-primary);
		}

		.ref-table td {
			padding: 6px 10px;
			border-bottom: 1px solid var(--border-color);
			color: var(--text-secondary);
		}

		.ref-table code {
			font-family: 'JetBrains Mono', monospace;
			font-size: 11px;
			background: var(--bg-primary);
			padding: 2px 6px;
			border-radius: 3px;
			color: var(--text-primary);
			cursor: pointer;
			transition: background 0.15s;
		}

		.ref-table code:hover {
			background: var(--accent);
			color: #fff;
		}

		.ref-scroll {
			max-height: 280px;
			overflow-y: auto;
		}

		.filter-tag {
			display: inline-block;
			font-family: 'JetBrains Mono', monospace;
			font-size: 11px;
			background: var(--bg-primary);
			border: 1px solid var(--border-color);
			padding: 3px 8px;
			border-radius: 4px;
			margin: 2px;
			color: var(--text-secondary);
		}

		.example-query {
			font-family: 'JetBrains Mono', monospace;
			font-size: 11px;
			background: var(--bg-code);
			color: #22c55e;
			padding: 8px 10px;
			border-radius: 4px;
			margin: 8px 0;
			cursor: pointer;
			word-break: break-all;
		}

		.example-query:hover { opacity: 0.9; }

		.help-text {
			font-size: 11px;
			color: var(--text-muted);
			margin-top: 4px;
		}

		footer {
			background: var(--bg-secondary);
			border-top: 1px solid var(--border-color);
			padding: 24px 0;
		}

		footer p { margin: 0; font-size: 13px; color: var(--text-muted); }

		.form-check-label { font-size: 13px; color: var(--text-secondary); }

		@media (max-width: 992px) {
			.main-content { padding: 24px 0 48px; }
		}
	</style>
</head>
<body>
	<nav class="navbar navbar-expand-lg">
		<div class="container">
			<a class="navbar-brand" href="../index.html">Shravan Kumar Sheri</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
					<li class="nav-item"><a class="nav-link" href="../blog.html">Blog</a></li>
					<li class="nav-item"><a class="nav-link active" href="../tools.html">Tools</a></li>
				</ul>
			</div>
		</div>
	</nav>

	<section class="page-header">
		<div class="container">
			<h1>LDAP Query Generator</h1>
			<p>Build complex LDAP queries for Active Directory enumeration</p>
		</div>
	</section>

	<section class="main-content">
		<div class="container">
			<div class="row">
				<div class="col-lg-8">
					<!-- Quick Presets -->
					<div class="card">
						<div class="card-header"><i class="fas fa-bolt"></i> Quick Presets</div>
						<div class="card-body">
							<p class="section-label">Users</p>
							<button class="preset-btn" onclick="setPreset('allUsers')">All Users</button>
							<button class="preset-btn" onclick="setPreset('enabledUsers')">Enabled Users</button>
							<button class="preset-btn" onclick="setPreset('disabledUsers')">Disabled Users</button>
							<button class="preset-btn" onclick="setPreset('lockedUsers')">Locked Users</button>
							<button class="preset-btn" onclick="setPreset('domainAdmins')">Domain Admins</button>
							<button class="preset-btn" onclick="setPreset('enterpriseAdmins')">Enterprise Admins</button>
							<button class="preset-btn" onclick="setPreset('adminCount')">AdminCount=1</button>
							<button class="preset-btn" onclick="setPreset('kerberoastable')">Kerberoastable</button>
							<button class="preset-btn" onclick="setPreset('asreproast')">AS-REP Roastable</button>
							<button class="preset-btn" onclick="setPreset('noPassRequired')">Password Not Required</button>
							<button class="preset-btn" onclick="setPreset('passNeverExpires')">Password Never Expires</button>
							<button class="preset-btn" onclick="setPreset('reversibleEnc')">Reversible Encryption</button>
							<button class="preset-btn" onclick="setPreset('unconstrained')">Unconstrained Delegation</button>
							<button class="preset-btn" onclick="setPreset('constrained')">Constrained Delegation</button>
							<button class="preset-btn" onclick="setPreset('sensitiveUsers')">Sensitive Users</button>
							<button class="preset-btn" onclick="setPreset('serviceAccounts')">Service Accounts</button>
							<button class="preset-btn" onclick="setPreset('recentlyCreated')">Recently Created</button>
							<button class="preset-btn" onclick="setPreset('neverLoggedIn')">Never Logged In</button>
							<button class="preset-btn" onclick="setPreset('staleUsers')">Stale Users (90 days)</button>

							<p class="section-label">Groups</p>
							<button class="preset-btn" onclick="setPreset('allGroups')">All Groups</button>
							<button class="preset-btn" onclick="setPreset('securityGroups')">Security Groups</button>
							<button class="preset-btn" onclick="setPreset('distributionGroups')">Distribution Groups</button>
							<button class="preset-btn" onclick="setPreset('domainLocalGroups')">Domain Local Groups</button>
							<button class="preset-btn" onclick="setPreset('globalGroups')">Global Groups</button>
							<button class="preset-btn" onclick="setPreset('universalGroups')">Universal Groups</button>
							<button class="preset-btn" onclick="setPreset('protectedGroups')">Protected Groups</button>
							<button class="preset-btn" onclick="setPreset('emptyGroups')">Empty Groups</button>

							<p class="section-label">Computers</p>
							<button class="preset-btn" onclick="setPreset('allComputers')">All Computers</button>
							<button class="preset-btn" onclick="setPreset('domainControllers')">Domain Controllers</button>
							<button class="preset-btn" onclick="setPreset('servers')">Servers</button>
							<button class="preset-btn" onclick="setPreset('workstations')">Workstations</button>
							<button class="preset-btn" onclick="setPreset('windows10')">Windows 10</button>
							<button class="preset-btn" onclick="setPreset('windows11')">Windows 11</button>
							<button class="preset-btn" onclick="setPreset('server2019')">Server 2019</button>
							<button class="preset-btn" onclick="setPreset('server2022')">Server 2022</button>
							<button class="preset-btn" onclick="setPreset('compUnconstrained')">Unconstrained Delegation</button>
							<button class="preset-btn" onclick="setPreset('compConstrained')">Constrained Delegation</button>
							<button class="preset-btn" onclick="setPreset('lapsEnabled')">LAPS Enabled</button>
							<button class="preset-btn" onclick="setPreset('trustedForDelegation')">Trusted for Delegation</button>
							<button class="preset-btn" onclick="setPreset('staleComputers')">Stale Computers</button>

							<p class="section-label">Security Objects</p>
							<button class="preset-btn" onclick="setPreset('gpos')">All GPOs</button>
							<button class="preset-btn" onclick="setPreset('ous')">All OUs</button>
							<button class="preset-btn" onclick="setPreset('trusts')">Domain Trusts</button>
							<button class="preset-btn" onclick="setPreset('gmsa')">gMSA Accounts</button>
							<button class="preset-btn" onclick="setPreset('msa')">MSA Accounts</button>
							<button class="preset-btn" onclick="setPreset('spns')">All SPNs</button>
						</div>
					</div>

					<!-- Custom Query Builder -->
					<div class="card">
						<div class="card-header"><i class="fas fa-cogs"></i> Custom Query Builder</div>
						<div class="card-body">
							<ul class="nav nav-tabs" id="builderTabs" role="tablist">
								<li class="nav-item">
									<a class="nav-link active" id="simple-tab" data-toggle="tab" href="#simple" role="tab">Simple</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="advanced-tab" data-toggle="tab" href="#advanced" role="tab">Advanced</a>
								</li>
							</ul>
							<div class="tab-content" id="builderTabsContent">
								<div class="tab-pane fade show active" id="simple" role="tabpanel">
									<div class="form-group">
										<label>Object Type</label>
										<select class="form-control" id="objectType" onchange="updateSimpleQuery()">
											<option value="user">User</option>
											<option value="group">Group</option>
											<option value="computer">Computer</option>
											<option value="any">Any Object</option>
										</select>
									</div>
									<div class="form-group">
										<label>Attribute</label>
										<select class="form-control" id="attribute" onchange="updateSimpleQuery()">
											<option value="cn">Common Name (cn)</option>
											<option value="sAMAccountName">SAM Account Name</option>
											<option value="displayName">Display Name</option>
											<option value="mail">Email</option>
											<option value="description">Description</option>
											<option value="memberOf">Member Of (Group DN)</option>
											<option value="department">Department</option>
											<option value="title">Title</option>
											<option value="manager">Manager (DN)</option>
											<option value="operatingSystem">Operating System</option>
											<option value="servicePrincipalName">Service Principal Name</option>
										</select>
									</div>
									<div class="form-group">
										<label>Operator</label>
										<select class="form-control" id="operator" onchange="updateSimpleQuery()">
											<option value="=">Equals</option>
											<option value="=*">Contains (wildcard)</option>
											<option value=">=">Greater Than or Equal</option>
											<option value="<=">Less Than or Equal</option>
											<option value="!">Not Equal</option>
										</select>
									</div>
									<div class="form-group">
										<label>Value</label>
										<input type="text" class="form-control" id="value" placeholder="Enter value..." onkeyup="updateSimpleQuery()">
									</div>
									<div class="form-group">
										<label>Additional Filters</label>
										<div class="form-check">
											<input class="form-check-input" type="checkbox" id="filterEnabled" onchange="updateSimpleQuery()">
											<label class="form-check-label" for="filterEnabled">Enabled Only</label>
										</div>
										<div class="form-check">
											<input class="form-check-input" type="checkbox" id="filterDisabled" onchange="updateSimpleQuery()">
											<label class="form-check-label" for="filterDisabled">Disabled Only</label>
										</div>
									</div>
								</div>
								<div class="tab-pane fade" id="advanced" role="tabpanel">
									<div class="form-group">
										<label>Base Object Class</label>
										<select class="form-control" id="advObjectClass">
											<option value="">Any</option>
											<option value="user">User</option>
											<option value="person">Person</option>
											<option value="group">Group</option>
											<option value="computer">Computer</option>
											<option value="organizationalUnit">Organizational Unit</option>
											<option value="groupPolicyContainer">Group Policy Object</option>
										</select>
									</div>
									<div id="filterContainer">
										<div class="filter-row mb-3" id="filter-0">
											<div class="row">
												<div class="col-md-2">
													<select class="form-control" id="logic-0">
														<option value="AND">AND</option>
														<option value="OR">OR</option>
														<option value="NOT">NOT</option>
													</select>
												</div>
												<div class="col-md-4">
													<input type="text" class="form-control" id="attr-0" placeholder="Attribute">
												</div>
												<div class="col-md-2">
													<select class="form-control" id="op-0">
														<option value="=">=</option>
														<option value=">=">>=</option>
														<option value="<="><=</option>
														<option value="~=">~=</option>
													</select>
												</div>
												<div class="col-md-4">
													<input type="text" class="form-control" id="val-0" placeholder="Value">
												</div>
											</div>
										</div>
									</div>
									<button class="btn btn-secondary btn-sm mt-2" onclick="addFilter()"><i class="fas fa-plus"></i> Add Filter</button>
									<button class="btn btn-secondary btn-sm mt-2" onclick="removeFilter()"><i class="fas fa-minus"></i> Remove Filter</button>
									<button class="btn btn-primary btn-sm mt-2 ml-2" onclick="buildAdvancedQuery()">Build Query</button>
								</div>
							</div>
						</div>
					</div>

					<!-- Output -->
					<div class="card">
						<div class="card-header"><i class="fas fa-terminal"></i> Generated Query</div>
						<div class="card-body">
							<ul class="nav nav-tabs" id="outputTabs" role="tablist">
								<li class="nav-item">
									<a class="nav-link active" id="ldap-tab" data-toggle="tab" href="#ldapOutput" role="tab">LDAP Filter</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="ps-tab" data-toggle="tab" href="#psOutput" role="tab">PowerShell</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="ldapsearch-tab" data-toggle="tab" href="#ldapsearchOutput" role="tab">ldapsearch</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="adfind-tab" data-toggle="tab" href="#adfindOutput" role="tab">ADFind</a>
								</li>
							</ul>
							<div class="tab-content">
								<div class="tab-pane fade show active" id="ldapOutput" role="tabpanel">
									<div class="output-area" id="queryOutput">
										<button class="copy-btn" onclick="copyQuery('queryOutput')"><i class="fas fa-copy"></i> Copy</button>
										<span id="ldapQuery">(objectClass=user)</span>
									</div>
								</div>
								<div class="tab-pane fade" id="psOutput" role="tabpanel">
									<div class="output-area ps" id="psQueryOutput">
										<button class="copy-btn" onclick="copyQuery('psQueryOutput')"><i class="fas fa-copy"></i> Copy</button>
										<span id="psQuery">Get-ADUser -LDAPFilter "(objectClass=user)"</span>
									</div>
								</div>
								<div class="tab-pane fade" id="ldapsearchOutput" role="tabpanel">
									<div class="output-area tool" id="ldapsearchQueryOutput">
										<button class="copy-btn" onclick="copyQuery('ldapsearchQueryOutput')"><i class="fas fa-copy"></i> Copy</button>
										<span id="ldapsearchQuery">ldapsearch -x -H ldap://DC -b "DC=domain,DC=com" "(objectClass=user)"</span>
									</div>
								</div>
								<div class="tab-pane fade" id="adfindOutput" role="tabpanel">
									<div class="output-area tool" id="adfindQueryOutput">
										<button class="copy-btn" onclick="copyQuery('adfindQueryOutput')"><i class="fas fa-copy"></i> Copy</button>
										<span id="adfindQuery">adfind -f "(objectClass=user)"</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="col-lg-4">
					<!-- Domain Settings -->
					<div class="card">
						<div class="card-header"><i class="fas fa-server"></i> Domain Settings</div>
						<div class="card-body">
							<div class="form-group">
								<label>Domain Controller</label>
								<input type="text" class="form-control" id="dcHost" placeholder="dc01.domain.com" value="DC">
							</div>
							<div class="form-group mb-0">
								<label>Base DN</label>
								<input type="text" class="form-control" id="baseDN" placeholder="DC=domain,DC=com" value="DC=domain,DC=com">
							</div>
						</div>
					</div>

					<!-- objectClass Values -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#objectClassCollapse">
							<i class="fas fa-cube"></i> objectClass Values <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="objectClassCollapse" class="collapse show">
							<div class="card-body ref-scroll p-0">
								<table class="ref-table">
									<thead><tr><th>Type</th><th>Value</th></tr></thead>
									<tbody>
										<tr><td>User</td><td><code onclick="insertFilter('objectClass=user')">user</code></td></tr>
										<tr><td>Person</td><td><code onclick="insertFilter('objectClass=person')">person</code></td></tr>
										<tr><td>Computer</td><td><code onclick="insertFilter('objectClass=computer')">computer</code></td></tr>
										<tr><td>Group</td><td><code onclick="insertFilter('objectClass=group')">group</code></td></tr>
										<tr><td>OU</td><td><code onclick="insertFilter('objectClass=organizationalUnit')">organizationalUnit</code></td></tr>
										<tr><td>Domain</td><td><code onclick="insertFilter('objectClass=domain')">domain</code></td></tr>
										<tr><td>GPO</td><td><code onclick="insertFilter('objectClass=groupPolicyContainer')">groupPolicyContainer</code></td></tr>
										<tr><td>Container</td><td><code onclick="insertFilter('objectClass=container')">container</code></td></tr>
										<tr><td>Trust</td><td><code onclick="insertFilter('objectClass=trustedDomain')">trustedDomain</code></td></tr>
										<tr><td>gMSA</td><td><code onclick="insertFilter('objectClass=msDS-GroupManagedServiceAccount')">msDS-GroupManagedServiceAccount</code></td></tr>
										<tr><td>MSA</td><td><code onclick="insertFilter('objectClass=msDS-ManagedServiceAccount')">msDS-ManagedServiceAccount</code></td></tr>
										<tr><td>FSP</td><td><code onclick="insertFilter('objectClass=foreignSecurityPrincipal')">foreignSecurityPrincipal</code></td></tr>
										<tr><td>Subnet</td><td><code onclick="insertFilter('objectClass=subnet')">subnet</code></td></tr>
										<tr><td>Site</td><td><code onclick="insertFilter('objectClass=site')">site</code></td></tr>
										<tr><td>DNS Zone</td><td><code onclick="insertFilter('objectClass=dnsZone')">dnsZone</code></td></tr>
										<tr><td>Contact</td><td><code onclick="insertFilter('objectClass=contact')">contact</code></td></tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>

					<!-- sAMAccountType -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#samAccountCollapse">
							<i class="fas fa-id-card"></i> sAMAccountType <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="samAccountCollapse" class="collapse">
							<div class="card-body p-0">
								<table class="ref-table">
									<thead><tr><th>Type</th><th>Value</th></tr></thead>
									<tbody>
										<tr><td>Domain Object</td><td><code onclick="insertFilter('sAMAccountType=0')">0</code></td></tr>
										<tr><td>Group</td><td><code onclick="insertFilter('sAMAccountType=268435456')">268435456</code></td></tr>
										<tr><td>Non-Sec Group</td><td><code onclick="insertFilter('sAMAccountType=268435457')">268435457</code></td></tr>
										<tr><td>Alias</td><td><code onclick="insertFilter('sAMAccountType=536870912')">536870912</code></td></tr>
										<tr><td>User</td><td><code onclick="insertFilter('sAMAccountType=805306368')">805306368</code></td></tr>
										<tr><td>Computer</td><td><code onclick="insertFilter('sAMAccountType=805306369')">805306369</code></td></tr>
										<tr><td>Trust</td><td><code onclick="insertFilter('sAMAccountType=805306370')">805306370</code></td></tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>

					<!-- primaryGroupID -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#primaryGroupCollapse">
							<i class="fas fa-users-cog"></i> primaryGroupID (RID) <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="primaryGroupCollapse" class="collapse">
							<div class="card-body p-0">
								<table class="ref-table">
									<thead><tr><th>Group</th><th>RID</th></tr></thead>
									<tbody>
										<tr><td>Domain Users</td><td><code onclick="insertFilter('primaryGroupID=513')">513</code></td></tr>
										<tr><td>Domain Admins</td><td><code onclick="insertFilter('primaryGroupID=512')">512</code></td></tr>
										<tr><td>Domain Computers</td><td><code onclick="insertFilter('primaryGroupID=515')">515</code></td></tr>
										<tr><td>Domain Controllers</td><td><code onclick="insertFilter('primaryGroupID=516')">516</code></td></tr>
										<tr><td>Domain Guests</td><td><code onclick="insertFilter('primaryGroupID=514')">514</code></td></tr>
										<tr><td>Schema Admins</td><td><code onclick="insertFilter('primaryGroupID=518')">518</code></td></tr>
										<tr><td>Enterprise Admins</td><td><code onclick="insertFilter('primaryGroupID=519')">519</code></td></tr>
										<tr><td>RODC</td><td><code onclick="insertFilter('primaryGroupID=521')">521</code></td></tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>

					<!-- UAC Flags -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#uacCollapse">
							<i class="fas fa-flag"></i> UserAccountControl Flags <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="uacCollapse" class="collapse">
							<div class="card-body ref-scroll p-0">
								<table class="ref-table">
									<thead><tr><th>Flag</th><th>Value</th></tr></thead>
									<tbody>
										<tr><td>SCRIPT</td><td><code onclick="insertUACFilter(1)">1</code></td></tr>
										<tr><td>ACCOUNTDISABLE</td><td><code onclick="insertUACFilter(2)">2</code></td></tr>
										<tr><td>HOMEDIR_REQUIRED</td><td><code onclick="insertUACFilter(8)">8</code></td></tr>
										<tr><td>LOCKOUT</td><td><code onclick="insertUACFilter(16)">16</code></td></tr>
										<tr><td>PASSWD_NOTREQD</td><td><code onclick="insertUACFilter(32)">32</code></td></tr>
										<tr><td>PASSWD_CANT_CHANGE</td><td><code onclick="insertUACFilter(64)">64</code></td></tr>
										<tr><td>ENCRYPTED_TEXT_PWD</td><td><code onclick="insertUACFilter(128)">128</code></td></tr>
										<tr><td>NORMAL_ACCOUNT</td><td><code onclick="insertUACFilter(512)">512</code></td></tr>
										<tr><td>INTERDOMAIN_TRUST</td><td><code onclick="insertUACFilter(2048)">2048</code></td></tr>
										<tr><td>WORKSTATION_TRUST</td><td><code onclick="insertUACFilter(4096)">4096</code></td></tr>
										<tr><td>SERVER_TRUST</td><td><code onclick="insertUACFilter(8192)">8192</code></td></tr>
										<tr><td>DONT_EXPIRE_PASSWORD</td><td><code onclick="insertUACFilter(65536)">65536</code></td></tr>
										<tr><td>SMARTCARD_REQUIRED</td><td><code onclick="insertUACFilter(262144)">262144</code></td></tr>
										<tr><td>TRUSTED_FOR_DELEGATION</td><td><code onclick="insertUACFilter(524288)">524288</code></td></tr>
										<tr><td>NOT_DELEGATED</td><td><code onclick="insertUACFilter(1048576)">1048576</code></td></tr>
										<tr><td>DONT_REQ_PREAUTH</td><td><code onclick="insertUACFilter(4194304)">4194304</code></td></tr>
										<tr><td>PASSWORD_EXPIRED</td><td><code onclick="insertUACFilter(8388608)">8388608</code></td></tr>
										<tr><td>TRUSTED_TO_AUTH</td><td><code onclick="insertUACFilter(16777216)">16777216</code></td></tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>

					<!-- Matching Rules -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#oidCollapse">
							<i class="fas fa-filter"></i> Matching Rules (OIDs) <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="oidCollapse" class="collapse">
							<div class="card-body" style="font-size: 12px;">
								<p><strong>LDAP_MATCHING_RULE_BIT_AND</strong><br>
								<code style="cursor:default;">1.2.840.113556.1.4.803</code><br>
								<span class="help-text">Bitwise AND - all bits must match</span></p>
								<p><strong>LDAP_MATCHING_RULE_BIT_OR</strong><br>
								<code style="cursor:default;">1.2.840.113556.1.4.804</code><br>
								<span class="help-text">Bitwise OR - any bit matches</span></p>
								<p><strong>LDAP_MATCHING_RULE_IN_CHAIN</strong><br>
								<code style="cursor:default;">1.2.840.113556.1.4.1941</code><br>
								<span class="help-text">Recursive search (nested groups)</span></p>
							</div>
						</div>
					</div>

					<!-- Example Queries -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#examplesCollapse">
							<i class="fas fa-lightbulb"></i> Example Queries <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="examplesCollapse" class="collapse">
							<div class="card-body" style="font-size: 12px;">
								<p><strong>ACL Enumeration Objects:</strong></p>
								<div class="example-query" onclick="setCustomQuery('(|(objectClass=domain)(objectClass=organizationalUnit)(objectClass=groupPolicyContainer))')">(|(objectClass=domain)(objectClass=organizationalUnit)(objectClass=groupPolicyContainer))</div>
								<p><strong>Users + Computers:</strong></p>
								<div class="example-query" onclick="setCustomQuery('(|(sAMAccountType=805306368)(sAMAccountType=805306369))')">(|(sAMAccountType=805306368)(sAMAccountType=805306369))</div>
								<p><strong>Nested Group Members:</strong></p>
								<div class="example-query" onclick="setCustomQuery('(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=domain,DC=com)')">(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,...)</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<footer>
		<div class="container">
			<p>&copy; 2025 Shravan Kumar Sheri</p>
		</div>
	</footer>

	<script>
		let filterCount = 1;

		const presets = {
			allUsers: '(&(objectCategory=person)(objectClass=user))',
			enabledUsers: '(&(objectCategory=person)(objectClass=user)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))',
			disabledUsers: '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=2))',
			lockedUsers: '(&(objectCategory=person)(objectClass=user)(lockoutTime>=1))',
			domainAdmins: '(&(objectCategory=person)(objectClass=user)(memberOf=CN=Domain Admins,CN=Users,DC=domain,DC=com))',
			enterpriseAdmins: '(&(objectCategory=person)(objectClass=user)(memberOf=CN=Enterprise Admins,CN=Users,DC=domain,DC=com))',
			adminCount: '(&(objectCategory=person)(objectClass=user)(adminCount=1))',
			kerberoastable: '(&(objectCategory=person)(objectClass=user)(servicePrincipalName=*)(!(userAccountControl:1.2.840.113556.1.4.803:=2))(!(cn=krbtgt)))',
			asreproast: '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=4194304))',
			noPassRequired: '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32))',
			passNeverExpires: '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536))',
			reversibleEnc: '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=128))',
			unconstrained: '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=524288)(!(userAccountControl:1.2.840.113556.1.4.803:=8192)))',
			constrained: '(&(objectCategory=person)(objectClass=user)(msDS-AllowedToDelegateTo=*))',
			sensitiveUsers: '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=1048576))',
			serviceAccounts: '(&(objectCategory=person)(objectClass=user)(servicePrincipalName=*)(!(sAMAccountName=krbtgt)))',
			recentlyCreated: '(&(objectCategory=person)(objectClass=user)(whenCreated>=20240101000000.0Z))',
			neverLoggedIn: '(&(objectCategory=person)(objectClass=user)(!(lastLogon=*))(!(lastLogonTimestamp=*)))',
			staleUsers: '(&(objectCategory=person)(objectClass=user)(lastLogonTimestamp<=132500000000000000))',
			allGroups: '(objectCategory=group)',
			securityGroups: '(&(objectCategory=group)(groupType:1.2.840.113556.1.4.803:=2147483648))',
			distributionGroups: '(&(objectCategory=group)(!(groupType:1.2.840.113556.1.4.803:=2147483648)))',
			domainLocalGroups: '(&(objectCategory=group)(groupType:1.2.840.113556.1.4.803:=4))',
			globalGroups: '(&(objectCategory=group)(groupType:1.2.840.113556.1.4.803:=2))',
			universalGroups: '(&(objectCategory=group)(groupType:1.2.840.113556.1.4.803:=8))',
			protectedGroups: '(&(objectCategory=group)(adminCount=1))',
			emptyGroups: '(&(objectCategory=group)(!(member=*)))',
			allComputers: '(objectCategory=computer)',
			domainControllers: '(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=8192))',
			servers: '(&(objectCategory=computer)(operatingSystem=*Server*))',
			workstations: '(&(objectCategory=computer)(!(operatingSystem=*Server*)))',
			windows10: '(&(objectCategory=computer)(operatingSystem=Windows 10*))',
			windows11: '(&(objectCategory=computer)(operatingSystem=Windows 11*))',
			server2019: '(&(objectCategory=computer)(operatingSystem=Windows Server 2019*))',
			server2022: '(&(objectCategory=computer)(operatingSystem=Windows Server 2022*))',
			compUnconstrained: '(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=524288)(!(userAccountControl:1.2.840.113556.1.4.803:=8192)))',
			compConstrained: '(&(objectCategory=computer)(msDS-AllowedToDelegateTo=*))',
			lapsEnabled: '(&(objectCategory=computer)(ms-Mcs-AdmPwdExpirationTime=*))',
			trustedForDelegation: '(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=524288))',
			staleComputers: '(&(objectCategory=computer)(lastLogonTimestamp<=132500000000000000))',
			gpos: '(objectCategory=groupPolicyContainer)',
			ous: '(objectCategory=organizationalUnit)',
			trusts: '(objectClass=trustedDomain)',
			gmsa: '(objectClass=msDS-GroupManagedServiceAccount)',
			msa: '(objectClass=msDS-ManagedServiceAccount)',
			spns: '(servicePrincipalName=*)'
		};

		function setPreset(presetName) {
			const query = presets[presetName];
			document.getElementById('ldapQuery').textContent = query;
			updateAllOutputs(query);
			document.querySelectorAll('.preset-btn').forEach(btn => btn.classList.remove('active'));
			event.target.classList.add('active');
		}

		function updateSimpleQuery() {
			const objType = document.getElementById('objectType').value;
			const attr = document.getElementById('attribute').value;
			const op = document.getElementById('operator').value;
			const val = document.getElementById('value').value;
			const enabledOnly = document.getElementById('filterEnabled').checked;
			const disabledOnly = document.getElementById('filterDisabled').checked;

			let objectFilter = '';
			switch(objType) {
				case 'user': objectFilter = '(objectCategory=person)(objectClass=user)'; break;
				case 'group': objectFilter = '(objectCategory=group)'; break;
				case 'computer': objectFilter = '(objectCategory=computer)'; break;
				default: objectFilter = '';
			}

			let attrFilter = '';
			if (val) {
				if (op === '=*') attrFilter = `(${attr}=*${val}*)`;
				else if (op === '!') attrFilter = `(!(${attr}=${val}))`;
				else attrFilter = `(${attr}${op}${val})`;
			}

			let uacFilter = '';
			if (enabledOnly) uacFilter = '(!(userAccountControl:1.2.840.113556.1.4.803:=2))';
			else if (disabledOnly) uacFilter = '(userAccountControl:1.2.840.113556.1.4.803:=2)';

			let query = '';
			if (objectFilter || attrFilter || uacFilter) {
				const parts = [objectFilter, attrFilter, uacFilter].filter(p => p);
				query = parts.length > 1 ? `(&${parts.join('')})` : parts[0] || '(objectClass=*)';
			} else {
				query = '(objectClass=*)';
			}

			document.getElementById('ldapQuery').textContent = query;
			updateAllOutputs(query);
		}

		function addFilter() {
			const container = document.getElementById('filterContainer');
			const newFilter = document.createElement('div');
			newFilter.className = 'filter-row mb-3';
			newFilter.id = `filter-${filterCount}`;
			newFilter.innerHTML = `
				<div class="row">
					<div class="col-md-2"><select class="form-control" id="logic-${filterCount}"><option value="AND">AND</option><option value="OR">OR</option><option value="NOT">NOT</option></select></div>
					<div class="col-md-4"><input type="text" class="form-control" id="attr-${filterCount}" placeholder="Attribute"></div>
					<div class="col-md-2"><select class="form-control" id="op-${filterCount}"><option value="=">=</option><option value=">=">>=</option><option value="<="><=</option><option value="~=">~=</option></select></div>
					<div class="col-md-4"><input type="text" class="form-control" id="val-${filterCount}" placeholder="Value"></div>
				</div>`;
			container.appendChild(newFilter);
			filterCount++;
		}

		function removeFilter() {
			if (filterCount > 1) {
				filterCount--;
				const element = document.getElementById(`filter-${filterCount}`);
				if (element) element.remove();
			}
		}

		function buildAdvancedQuery() {
			const objClass = document.getElementById('advObjectClass').value;
			let filters = [];
			if (objClass) filters.push(`(objectClass=${objClass})`);
			for (let i = 0; i < filterCount; i++) {
				const attr = document.getElementById(`attr-${i}`);
				const val = document.getElementById(`val-${i}`);
				const op = document.getElementById(`op-${i}`);
				const logic = document.getElementById(`logic-${i}`);
				if (attr && val && attr.value && val.value) {
					let filter = `(${attr.value}${op.value}${val.value})`;
					if (logic.value === 'NOT') filter = `(!${filter})`;
					filters.push(filter);
				}
			}
			let query = filters.length > 1 ? `(&${filters.join('')})` : filters.length === 1 ? filters[0] : '(objectClass=*)';
			document.getElementById('ldapQuery').textContent = query;
			updateAllOutputs(query);
		}

		function updateAllOutputs(query) {
			const dc = document.getElementById('dcHost').value || 'DC';
			const baseDN = document.getElementById('baseDN').value || 'DC=domain,DC=com';
			let psCmd = '';
			if (query.includes('objectCategory=person') || query.includes('objectClass=user')) psCmd = `Get-ADUser -LDAPFilter "${query}" -Properties *`;
			else if (query.includes('objectCategory=group')) psCmd = `Get-ADGroup -LDAPFilter "${query}" -Properties *`;
			else if (query.includes('objectCategory=computer')) psCmd = `Get-ADComputer -LDAPFilter "${query}" -Properties *`;
			else psCmd = `Get-ADObject -LDAPFilter "${query}" -Properties *`;
			document.getElementById('psQuery').textContent = psCmd;
			document.getElementById('ldapsearchQuery').textContent = `ldapsearch -x -H ldap://${dc} -b "${baseDN}" "${query}"`;
			document.getElementById('adfindQuery').textContent = `adfind -h ${dc} -b "${baseDN}" -f "${query}"`;
		}

		function copyQuery(elementId) {
			const element = document.getElementById(elementId);
			const text = element.querySelector('span').textContent;
			navigator.clipboard.writeText(text).then(() => {
				const btn = element.querySelector('.copy-btn');
				btn.innerHTML = '<i class="fas fa-check"></i> Copied';
				setTimeout(() => { btn.innerHTML = '<i class="fas fa-copy"></i> Copy'; }, 2000);
			});
		}

		function insertFilter(filter) {
			const query = `(${filter})`;
			document.getElementById('ldapQuery').textContent = query;
			updateAllOutputs(query);
		}

		function insertUACFilter(value) {
			const query = `(userAccountControl:1.2.840.113556.1.4.803:=${value})`;
			document.getElementById('ldapQuery').textContent = query;
			updateAllOutputs(query);
		}

		function setCustomQuery(query) {
			document.getElementById('ldapQuery').textContent = query;
			updateAllOutputs(query);
		}

		document.addEventListener('DOMContentLoaded', function() { updateSimpleQuery(); });
	</script>
</body>
</html>
