<!DOCTYPE html>
<html>
<head>
	<title>BloodHound Cypher Generator - Security Tools</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Generate Cypher queries for BloodHound and Neo4j - find attack paths, ACL abuse, Kerberos delegation, and more.">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<style>
		:root {
			--bg-primary: #fafafa;
			--bg-secondary: #fff;
			--bg-code: #18181b;
			--text-primary: #171717;
			--text-secondary: #525252;
			--text-muted: #a3a3a3;
			--border-color: #e5e5e5;
			--accent: #171717;
			--accent-hover: #404040;
			--code-text: #a1a1aa;
		}

		* { box-sizing: border-box; }

		body {
			font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
			background-color: var(--bg-primary);
			color: var(--text-primary);
			margin: 0;
			padding: 0;
			line-height: 1.6;
			-webkit-font-smoothing: antialiased;
		}

		.navbar {
			background-color: var(--bg-secondary);
			padding: 16px 0;
			border-bottom: 1px solid var(--border-color);
		}

		.navbar-brand { color: var(--text-primary) !important; font-size: 15px; font-weight: 600; }
		.nav-link { color: var(--text-secondary) !important; font-size: 14px; font-weight: 500; margin-left: 24px; }
		.nav-link:hover, .nav-link.active { color: var(--text-primary) !important; }

		.page-header {
			background: var(--bg-secondary);
			border-bottom: 1px solid var(--border-color);
			padding: 32px 0;
		}

		.page-header h1 { font-size: 24px; font-weight: 700; letter-spacing: -0.02em; margin: 0; }
		.page-header p { font-size: 14px; color: var(--text-secondary); margin: 8px 0 0 0; }

		.main-content { padding: 32px 0 64px; }

		.card {
			background: var(--bg-secondary);
			border: 1px solid var(--border-color);
			border-radius: 8px;
			margin-bottom: 20px;
		}

		.card-header {
			background: transparent;
			border-bottom: 1px solid var(--border-color);
			padding: 14px 20px;
			font-size: 13px;
			font-weight: 600;
			color: var(--text-primary);
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.card-header i { color: var(--text-muted); font-size: 12px; }
		.card-header[data-toggle="collapse"] { cursor: pointer; }
		.card-header .float-right { margin-left: auto; }

		.card-body { padding: 20px; }

		.accordion .card { margin-bottom: 8px; }
		.accordion .card-header { padding: 12px 16px; }

		.preset-btn {
			display: inline-block;
			margin: 3px;
			font-size: 12px;
			padding: 5px 10px;
			border-radius: 4px;
			border: 1px solid var(--border-color);
			background: var(--bg-secondary);
			color: var(--text-secondary);
			cursor: pointer;
			transition: all 0.15s;
			font-family: 'Inter', sans-serif;
		}

		.preset-btn:hover { border-color: var(--text-muted); color: var(--text-primary); }
		.preset-btn.active { background: var(--accent); border-color: var(--accent); color: #fff; }

		.form-group label { font-size: 13px; font-weight: 500; color: var(--text-primary); margin-bottom: 6px; }

		.form-control {
			font-family: 'Inter', sans-serif;
			font-size: 13px;
			border: 1px solid var(--border-color);
			border-radius: 6px;
			padding: 8px 12px;
		}

		.form-control:focus { border-color: var(--text-muted); box-shadow: none; }

		.btn-primary {
			background: var(--accent);
			border: none;
			padding: 8px 16px;
			font-size: 13px;
			font-weight: 500;
			border-radius: 6px;
		}

		.btn-primary:hover { background: var(--accent-hover); }

		.output-area {
			background: var(--bg-code);
			color: #22c55e;
			font-family: 'JetBrains Mono', monospace;
			padding: 16px;
			border-radius: 6px;
			font-size: 13px;
			white-space: pre-wrap;
			word-break: break-all;
			min-height: 100px;
			position: relative;
		}

		.copy-btn {
			position: absolute;
			top: 8px;
			right: 8px;
			background: rgba(255,255,255,0.1);
			border: none;
			color: var(--code-text);
			padding: 4px 10px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 11px;
			font-family: 'Inter', sans-serif;
		}

		.copy-btn:hover { background: rgba(255,255,255,0.15); color: #fff; }

		.query-desc {
			background: var(--bg-primary);
			border-left: 3px solid var(--border-color);
			padding: 12px 16px;
			margin-bottom: 16px;
			font-size: 13px;
			color: var(--text-secondary);
		}

		.node-badge {
			display: inline-block;
			padding: 2px 8px;
			border-radius: 4px;
			font-size: 11px;
			font-weight: 500;
			margin: 2px;
			border: 1px solid var(--border-color);
			background: var(--bg-primary);
			color: var(--text-secondary);
		}

		.edge-badge {
			display: inline-block;
			padding: 2px 8px;
			border-radius: 4px;
			font-size: 11px;
			font-weight: 500;
			font-family: 'JetBrains Mono', monospace;
			margin: 2px;
			background: var(--bg-code);
			color: #f97316;
		}

		.ref-scroll { max-height: 240px; overflow-y: auto; }

		footer {
			background: var(--bg-secondary);
			border-top: 1px solid var(--border-color);
			padding: 24px 0;
		}

		footer p { margin: 0; font-size: 13px; color: var(--text-muted); }

		.syntax-ref { font-size: 12px; }
		.syntax-ref code {
			font-family: 'JetBrains Mono', monospace;
			font-size: 11px;
			background: var(--bg-primary);
			padding: 2px 6px;
			border-radius: 3px;
		}

		@media (max-width: 992px) {
			.main-content { padding: 24px 0 48px; }
		}
	</style>
</head>
<body>
	<nav class="navbar navbar-expand-lg">
		<div class="container">
			<a class="navbar-brand" href="../index.html">Shravan Kumar Sheri</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
					<li class="nav-item"><a class="nav-link" href="../blog.html">Blog</a></li>
					<li class="nav-item"><a class="nav-link active" href="../tools.html">Tools</a></li>
				</ul>
			</div>
		</div>
	</nav>

	<section class="page-header">
		<div class="container">
			<h1>BloodHound Cypher Generator</h1>
			<p>Generate Cypher queries for BloodHound CE / Neo4j to analyze AD attack paths</p>
		</div>
	</section>

	<section class="main-content">
		<div class="container">
			<div class="row">
				<div class="col-lg-8">
					<!-- Settings -->
					<div class="card">
						<div class="card-header"><i class="fas fa-cog"></i> Query Settings</div>
						<div class="card-body">
							<div class="row">
								<div class="col-md-6">
									<div class="form-group mb-0">
										<label>Domain Name (uppercase)</label>
										<input type="text" class="form-control" id="domainName" placeholder="DOMAIN.COM" value="DOMAIN.COM" onchange="regenerateQuery()">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group mb-0">
										<label>Target User/Group/Computer</label>
										<input type="text" class="form-control" id="targetNode" placeholder="JOHN@DOMAIN.COM" onchange="regenerateQuery()">
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Query Categories -->
					<div class="accordion" id="queryAccordion">
						<div class="card">
							<div class="card-header" data-toggle="collapse" data-target="#pathFinding">
								<i class="fas fa-route"></i> Path Finding <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="pathFinding" class="collapse show" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('shortestDA')">Shortest Path to DA</button>
									<button class="preset-btn" onclick="setPreset('shortestFromUser')">Path from User to DA</button>
									<button class="preset-btn" onclick="setPreset('shortestFromGroup')">Path from Group to DA</button>
									<button class="preset-btn" onclick="setPreset('shortestFromComputer')">Path from Computer to DA</button>
									<button class="preset-btn" onclick="setPreset('allPathsDA')">All Paths to DA</button>
									<button class="preset-btn" onclick="setPreset('shortestDC')">Shortest Path to DC</button>
									<button class="preset-btn" onclick="setPreset('ownedToDA')">Owned to DA</button>
									<button class="preset-btn" onclick="setPreset('pathLength')">Paths by Length</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#kerberos">
								<i class="fas fa-key"></i> Kerberos Attacks <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="kerberos" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('kerberoastable')">Kerberoastable Users</button>
									<button class="preset-btn" onclick="setPreset('kerberoastableHA')">Kerberoastable High Value</button>
									<button class="preset-btn" onclick="setPreset('asrep')">AS-REP Roastable</button>
									<button class="preset-btn" onclick="setPreset('unconstrained')">Unconstrained Delegation</button>
									<button class="preset-btn" onclick="setPreset('constrainedUser')">Constrained Delegation (Users)</button>
									<button class="preset-btn" onclick="setPreset('constrainedComp')">Constrained Delegation (Computers)</button>
									<button class="preset-btn" onclick="setPreset('rbcd')">RBCD Targets</button>
									<button class="preset-btn" onclick="setPreset('rbcdPath')">RBCD Attack Path</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#aclAbuse">
								<i class="fas fa-shield-alt"></i> ACL Abuse <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="aclAbuse" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('genericAll')">GenericAll on Users</button>
									<button class="preset-btn" onclick="setPreset('genericAllGroup')">GenericAll on Groups</button>
									<button class="preset-btn" onclick="setPreset('genericAllComp')">GenericAll on Computers</button>
									<button class="preset-btn" onclick="setPreset('genericWrite')">GenericWrite</button>
									<button class="preset-btn" onclick="setPreset('writeDacl')">WriteDACL</button>
									<button class="preset-btn" onclick="setPreset('writeOwner')">WriteOwner</button>
									<button class="preset-btn" onclick="setPreset('forceChangePass')">ForceChangePassword</button>
									<button class="preset-btn" onclick="setPreset('addMember')">AddMember</button>
									<button class="preset-btn" onclick="setPreset('dcsync')">DCSync Rights</button>
									<button class="preset-btn" onclick="setPreset('addSelf')">AddSelf</button>
									<button class="preset-btn" onclick="setPreset('allExtendedRights')">AllExtendedRights</button>
									<button class="preset-btn" onclick="setPreset('owns')">Object Ownership</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#sessions">
								<i class="fas fa-desktop"></i> Sessions & Local Admin <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="sessions" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('userSessions')">User Sessions</button>
									<button class="preset-btn" onclick="setPreset('adminSessions')">DA Sessions</button>
									<button class="preset-btn" onclick="setPreset('localAdmins')">Local Admins</button>
									<button class="preset-btn" onclick="setPreset('rdpUsers')">RDP Users</button>
									<button class="preset-btn" onclick="setPreset('dcomUsers')">DCOM Users</button>
									<button class="preset-btn" onclick="setPreset('psRemote')">PSRemote Users</button>
									<button class="preset-btn" onclick="setPreset('sqlAdmin')">SQL Admins</button>
									<button class="preset-btn" onclick="setPreset('canRDP')">CanRDP Paths</button>
									<button class="preset-btn" onclick="setPreset('canPSRemote')">CanPSRemote Paths</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#groups">
								<i class="fas fa-users"></i> Group Analysis <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="groups" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('daMembers')">Domain Admin Members</button>
									<button class="preset-btn" onclick="setPreset('eaMembers')">Enterprise Admin Members</button>
									<button class="preset-btn" onclick="setPreset('nestedGroups')">Nested Group Membership</button>
									<button class="preset-btn" onclick="setPreset('foreignMembers')">Foreign Domain Members</button>
									<button class="preset-btn" onclick="setPreset('highValueGroups')">High Value Groups</button>
									<button class="preset-btn" onclick="setPreset('adminGroups')">All Admin Groups</button>
									<button class="preset-btn" onclick="setPreset('groupsCanRDP')">Groups with RDP</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#computers">
								<i class="fas fa-server"></i> Computer Analysis <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="computers" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('allComputers')">All Computers</button>
									<button class="preset-btn" onclick="setPreset('domainControllers')">Domain Controllers</button>
									<button class="preset-btn" onclick="setPreset('lapsComputers')">LAPS Enabled</button>
									<button class="preset-btn" onclick="setPreset('noLaps')">No LAPS</button>
									<button class="preset-btn" onclick="setPreset('windows10')">Windows 10</button>
									<button class="preset-btn" onclick="setPreset('windows11')">Windows 11</button>
									<button class="preset-btn" onclick="setPreset('server2019')">Server 2019</button>
									<button class="preset-btn" onclick="setPreset('server2022')">Server 2022</button>
									<button class="preset-btn" onclick="setPreset('unsupportedOS')">Unsupported OS</button>
									<button class="preset-btn" onclick="setPreset('compWithSessions')">Computers with Sessions</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#users">
								<i class="fas fa-user"></i> User Analysis <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="users" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('allUsers')">All Users</button>
									<button class="preset-btn" onclick="setPreset('enabledUsers')">Enabled Users</button>
									<button class="preset-btn" onclick="setPreset('disabledUsers')">Disabled Users</button>
									<button class="preset-btn" onclick="setPreset('highValueUsers')">High Value Users</button>
									<button class="preset-btn" onclick="setPreset('adminCount')">AdminCount=1</button>
									<button class="preset-btn" onclick="setPreset('passNotReq')">Password Not Required</button>
									<button class="preset-btn" onclick="setPreset('passNeverExp')">Password Never Expires</button>
									<button class="preset-btn" onclick="setPreset('ownedUsers')">Owned Users</button>
									<button class="preset-btn" onclick="setPreset('sensitiveUsers')">Sensitive Users</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#gpo">
								<i class="fas fa-clipboard-list"></i> GPO Analysis <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="gpo" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('allGPOs')">All GPOs</button>
									<button class="preset-btn" onclick="setPreset('gpoOnDA')">GPOs Affecting DAs</button>
									<button class="preset-btn" onclick="setPreset('gpoOnDC')">GPOs on DCs</button>
									<button class="preset-btn" onclick="setPreset('gpoControllers')">GPO Controllers</button>
									<button class="preset-btn" onclick="setPreset('gpoToComputer')">GPO to Computer Path</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#trusts">
								<i class="fas fa-handshake"></i> Domain & Trusts <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="trusts" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('allDomains')">All Domains</button>
									<button class="preset-btn" onclick="setPreset('domainTrusts')">Domain Trusts</button>
									<button class="preset-btn" onclick="setPreset('foreignGroups')">Foreign Group Membership</button>
									<button class="preset-btn" onclick="setPreset('crossDomainPaths')">Cross-Domain Paths</button>
									<button class="preset-btn" onclick="setPreset('sidHistory')">SID History Abuse</button>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-header collapsed" data-toggle="collapse" data-target="#stats">
								<i class="fas fa-chart-bar"></i> Statistics <i class="fas fa-chevron-down float-right"></i>
							</div>
							<div id="stats" class="collapse" data-parent="#queryAccordion">
								<div class="card-body">
									<button class="preset-btn" onclick="setPreset('nodeCount')">Node Counts</button>
									<button class="preset-btn" onclick="setPreset('edgeCount')">Edge Counts</button>
									<button class="preset-btn" onclick="setPreset('daCount')">Domain Admins Count</button>
									<button class="preset-btn" onclick="setPreset('computerOS')">Computers by OS</button>
									<button class="preset-btn" onclick="setPreset('usersPerGroup')">Users per Group</button>
								</div>
							</div>
						</div>
					</div>

					<!-- Output -->
					<div class="card">
						<div class="card-header"><i class="fas fa-terminal"></i> Generated Cypher Query</div>
						<div class="card-body">
							<div class="query-desc" id="queryDescription">Select a preset query above or build a custom query.</div>
							<div class="output-area" id="cypherOutput">
								<button class="copy-btn" onclick="copyQuery()"><i class="fas fa-copy"></i> Copy</button>
								<span id="cypherQuery">// Select a query preset above</span>
							</div>
						</div>
					</div>
				</div>

				<div class="col-lg-4">
					<!-- Custom Query Builder -->
					<div class="card">
						<div class="card-header"><i class="fas fa-hammer"></i> Custom Query Builder</div>
						<div class="card-body">
							<div class="form-group">
								<label>Find Node Type</label>
								<select class="form-control" id="customNodeType">
									<option value="User">User</option>
									<option value="Group">Group</option>
									<option value="Computer">Computer</option>
									<option value="Domain">Domain</option>
									<option value="GPO">GPO</option>
									<option value="OU">OU</option>
								</select>
							</div>
							<div class="form-group">
								<label>With Relationship</label>
								<select class="form-control" id="customEdgeType">
									<option value="">Any Path (*)</option>
									<option value="MemberOf">MemberOf</option>
									<option value="AdminTo">AdminTo</option>
									<option value="HasSession">HasSession</option>
									<option value="GenericAll">GenericAll</option>
									<option value="GenericWrite">GenericWrite</option>
									<option value="WriteDacl">WriteDacl</option>
									<option value="WriteOwner">WriteOwner</option>
									<option value="Owns">Owns</option>
									<option value="ForceChangePassword">ForceChangePassword</option>
									<option value="AddMember">AddMember</option>
									<option value="CanRDP">CanRDP</option>
									<option value="CanPSRemote">CanPSRemote</option>
									<option value="ExecuteDCOM">ExecuteDCOM</option>
									<option value="AllowedToDelegate">AllowedToDelegate</option>
									<option value="AllowedToAct">AllowedToAct</option>
									<option value="GetChanges">GetChanges</option>
									<option value="GetChangesAll">GetChangesAll</option>
									<option value="Contains">Contains</option>
									<option value="GpLink">GpLink</option>
								</select>
							</div>
							<div class="form-group">
								<label>To Target Type</label>
								<select class="form-control" id="customTargetType">
									<option value="User">User</option>
									<option value="Group">Group</option>
									<option value="Computer">Computer</option>
									<option value="Domain">Domain</option>
									<option value="GPO">GPO</option>
									<option value="OU">OU</option>
								</select>
							</div>
							<div class="form-group">
								<label>Target Name (optional)</label>
								<input type="text" class="form-control" id="customTargetName" placeholder="DOMAIN ADMINS">
							</div>
							<button class="btn btn-primary btn-block" onclick="buildCustomQuery()">Generate Query</button>
						</div>
					</div>

					<!-- Node Types -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#nodeTypes">
							<i class="fas fa-circle"></i> Node Types <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="nodeTypes" class="collapse show">
							<div class="card-body">
								<span class="node-badge">User</span>
								<span class="node-badge">Group</span>
								<span class="node-badge">Computer</span>
								<span class="node-badge">Domain</span>
								<span class="node-badge">GPO</span>
								<span class="node-badge">OU</span>
							</div>
						</div>
					</div>

					<!-- Edge Types -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#edgeTypes">
							<i class="fas fa-arrow-right"></i> Edge Types <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="edgeTypes" class="collapse">
							<div class="card-body ref-scroll">
								<p style="font-size:11px;font-weight:600;color:var(--text-muted);margin-bottom:8px;">GROUP</p>
								<span class="edge-badge">MemberOf</span>
								<span class="edge-badge">AddMember</span>
								<span class="edge-badge">AddSelf</span>
								<p style="font-size:11px;font-weight:600;color:var(--text-muted);margin:12px 0 8px 0;">ACL</p>
								<span class="edge-badge">GenericAll</span>
								<span class="edge-badge">GenericWrite</span>
								<span class="edge-badge">WriteDacl</span>
								<span class="edge-badge">WriteOwner</span>
								<span class="edge-badge">Owns</span>
								<span class="edge-badge">ForceChangePassword</span>
								<span class="edge-badge">AllExtendedRights</span>
								<p style="font-size:11px;font-weight:600;color:var(--text-muted);margin:12px 0 8px 0;">SESSIONS</p>
								<span class="edge-badge">AdminTo</span>
								<span class="edge-badge">HasSession</span>
								<span class="edge-badge">CanRDP</span>
								<span class="edge-badge">CanPSRemote</span>
								<span class="edge-badge">ExecuteDCOM</span>
								<span class="edge-badge">SQLAdmin</span>
								<p style="font-size:11px;font-weight:600;color:var(--text-muted);margin:12px 0 8px 0;">DELEGATION</p>
								<span class="edge-badge">AllowedToDelegate</span>
								<span class="edge-badge">AllowedToAct</span>
								<p style="font-size:11px;font-weight:600;color:var(--text-muted);margin:12px 0 8px 0;">DCSYNC</p>
								<span class="edge-badge">GetChanges</span>
								<span class="edge-badge">GetChangesAll</span>
							</div>
						</div>
					</div>

					<!-- Cypher Syntax -->
					<div class="card">
						<div class="card-header" data-toggle="collapse" href="#syntaxRef">
							<i class="fas fa-code"></i> Cypher Syntax <i class="fas fa-chevron-down float-right"></i>
						</div>
						<div id="syntaxRef" class="collapse">
							<div class="card-body syntax-ref">
								<code>MATCH (n:User)</code> - Find all users<br><br>
								<code>(n)-[:MemberOf]->(g)</code> - Direct relationship<br><br>
								<code>(n)-[:MemberOf*1..]->(g)</code> - Recursive (1+ hops)<br><br>
								<code>(n)-[*1..]->(g)</code> - Any edge type<br><br>
								<code>WHERE n.name =~ '.*ADMIN.*'</code> - Regex match<br><br>
								<code>shortestPath((a)-[*1..]->(b))</code> - Shortest path
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<footer>
		<div class="container">
			<p>&copy; 2025 Shravan Kumar Sheri</p>
		</div>
	</footer>

	<script>
		let currentPreset = '';

		const presets = {
			shortestDA: { query: `MATCH p=shortestPath((n)-[*1..]->(g:Group))\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nAND n<>g\nRETURN p`, desc: 'Find the shortest path from any node to Domain Admins group.' },
			shortestFromUser: { query: `MATCH p=shortestPath((n:User {name:"TARGET@DOMAIN.COM"})-[*1..]->(g:Group))\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN p`, desc: 'Find shortest path from a specific user to Domain Admins.' },
			shortestFromGroup: { query: `MATCH p=shortestPath((n:Group {name:"SOURCE GROUP@DOMAIN.COM"})-[*1..]->(g:Group))\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN p`, desc: 'Find shortest path from a specific group to Domain Admins.' },
			shortestFromComputer: { query: `MATCH p=shortestPath((n:Computer {name:"COMPUTER.DOMAIN.COM"})-[*1..]->(g:Group))\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN p`, desc: 'Find shortest path from a specific computer to Domain Admins.' },
			allPathsDA: { query: `MATCH p=allShortestPaths((n)-[*1..]->(g:Group))\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nAND n<>g\nRETURN p LIMIT 50`, desc: 'Find all shortest paths to Domain Admins (limited to 50).' },
			shortestDC: { query: `MATCH p=shortestPath((n)-[*1..]->(c:Computer))\nWHERE c.name =~ "(?i).*DC.*"\nAND n<>c\nRETURN p`, desc: 'Find shortest paths to Domain Controllers.' },
			ownedToDA: { query: `MATCH p=shortestPath((n {owned:true})-[*1..]->(g:Group))\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN p`, desc: 'Find paths from owned nodes to Domain Admins.' },
			pathLength: { query: `MATCH p=(n)-[*1..5]->(g:Group)\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN p, length(p) as pathLength\nORDER BY pathLength`, desc: 'Find paths to DA with specific length (1-5 hops).' },
			kerberoastable: { query: `MATCH (n:User)\nWHERE n.hasspn = true\nAND n.enabled = true\nRETURN n.name, n.serviceprincipalnames`, desc: 'Find all Kerberoastable users (users with SPNs set).' },
			kerberoastableHA: { query: `MATCH (n:User)\nWHERE n.hasspn = true\nAND n.enabled = true\nAND n.highvalue = true\nRETURN n.name, n.serviceprincipalnames`, desc: 'Find Kerberoastable high-value users.' },
			asrep: { query: `MATCH (n:User)\nWHERE n.dontreqpreauth = true\nAND n.enabled = true\nRETURN n.name`, desc: 'Find AS-REP Roastable users (no Kerberos pre-auth required).' },
			unconstrained: { query: `MATCH (c:Computer)\nWHERE c.unconstraineddelegation = true\nAND NOT c.name CONTAINS "DC"\nRETURN c.name`, desc: 'Find computers with unconstrained delegation (excluding DCs).' },
			constrainedUser: { query: `MATCH (u:User)\nWHERE u.allowedtodelegate IS NOT NULL\nRETURN u.name, u.allowedtodelegate`, desc: 'Find users with constrained delegation.' },
			constrainedComp: { query: `MATCH (c:Computer)\nWHERE c.allowedtodelegate IS NOT NULL\nRETURN c.name, c.allowedtodelegate`, desc: 'Find computers with constrained delegation.' },
			rbcd: { query: `MATCH p=(n)-[:AllowedToAct]->(c:Computer)\nRETURN p`, desc: 'Find Resource-Based Constrained Delegation targets.' },
			rbcdPath: { query: `MATCH p=shortestPath((u:User)-[*1..]->(c:Computer))\nWHERE EXISTS((c)-[:AllowedToAct]->())\nRETURN p`, desc: 'Find paths to computers that allow RBCD.' },
			genericAll: { query: `MATCH p=(n)-[:GenericAll]->(u:User)\nWHERE n<>u\nRETURN p`, desc: 'Find nodes with GenericAll rights on users.' },
			genericAllGroup: { query: `MATCH p=(n)-[:GenericAll]->(g:Group)\nRETURN p`, desc: 'Find nodes with GenericAll rights on groups.' },
			genericAllComp: { query: `MATCH p=(n)-[:GenericAll]->(c:Computer)\nRETURN p`, desc: 'Find nodes with GenericAll rights on computers.' },
			genericWrite: { query: `MATCH p=(n)-[:GenericWrite]->(m)\nWHERE n<>m\nRETURN p`, desc: 'Find nodes with GenericWrite permissions.' },
			writeDacl: { query: `MATCH p=(n)-[:WriteDacl]->(m)\nWHERE n<>m\nRETURN p`, desc: 'Find nodes with WriteDACL permissions.' },
			writeOwner: { query: `MATCH p=(n)-[:WriteOwner]->(m)\nWHERE n<>m\nRETURN p`, desc: 'Find nodes with WriteOwner permissions.' },
			forceChangePass: { query: `MATCH p=(n)-[:ForceChangePassword]->(u:User)\nWHERE n<>u\nRETURN p`, desc: 'Find nodes that can force password change on users.' },
			addMember: { query: `MATCH p=(n)-[:AddMember]->(g:Group)\nRETURN p`, desc: 'Find nodes that can add members to groups.' },
			dcsync: { query: `MATCH p=(n)-[:GetChanges|GetChangesAll*1..2]->(d:Domain)\nRETURN p`, desc: 'Find principals with DCSync rights.' },
			addSelf: { query: `MATCH p=(n)-[:AddSelf]->(g:Group)\nRETURN p`, desc: 'Find nodes that can add themselves to groups.' },
			allExtendedRights: { query: `MATCH p=(n)-[:AllExtendedRights]->(m)\nRETURN p`, desc: 'Find nodes with AllExtendedRights permission.' },
			owns: { query: `MATCH p=(n)-[:Owns]->(m)\nWHERE NOT n.name CONTAINS "ADMIN"\nRETURN p`, desc: 'Find object ownership (excluding known admins).' },
			userSessions: { query: `MATCH p=(c:Computer)-[:HasSession]->(u:User)\nRETURN u.name, c.name`, desc: 'Find all active user sessions.' },
			adminSessions: { query: `MATCH (u:User)-[:MemberOf*1..]->(g:Group)\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nWITH u\nMATCH p=(c:Computer)-[:HasSession]->(u)\nRETURN p`, desc: 'Find Domain Admin sessions on computers.' },
			localAdmins: { query: `MATCH p=(n)-[:AdminTo]->(c:Computer)\nRETURN p`, desc: 'Find all local admin relationships.' },
			rdpUsers: { query: `MATCH p=(n)-[:CanRDP]->(c:Computer)\nRETURN p`, desc: 'Find users with RDP access.' },
			dcomUsers: { query: `MATCH p=(n)-[:ExecuteDCOM]->(c:Computer)\nRETURN p`, desc: 'Find users with DCOM execution rights.' },
			psRemote: { query: `MATCH p=(n)-[:CanPSRemote]->(c:Computer)\nRETURN p`, desc: 'Find users with PSRemote access.' },
			sqlAdmin: { query: `MATCH p=(n)-[:SQLAdmin]->(c:Computer)\nRETURN p`, desc: 'Find SQL Admin relationships.' },
			canRDP: { query: `MATCH p=shortestPath((u:User {name:"TARGET@DOMAIN.COM"})-[:CanRDP|MemberOf*1..]->(c:Computer))\nRETURN p`, desc: 'Find RDP paths from specific user.' },
			canPSRemote: { query: `MATCH p=shortestPath((u:User {name:"TARGET@DOMAIN.COM"})-[:CanPSRemote|MemberOf*1..]->(c:Computer))\nRETURN p`, desc: 'Find PSRemote paths from specific user.' },
			daMembers: { query: `MATCH (u:User)-[:MemberOf*1..]->(g:Group)\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN DISTINCT u.name`, desc: 'List all Domain Admin members (including nested).' },
			eaMembers: { query: `MATCH (u:User)-[:MemberOf*1..]->(g:Group)\nWHERE g.name =~ "(?i).*ENTERPRISE ADMINS.*"\nRETURN DISTINCT u.name`, desc: 'List all Enterprise Admin members (including nested).' },
			nestedGroups: { query: `MATCH p=(g1:Group)-[:MemberOf*1..]->(g2:Group)\nRETURN p`, desc: 'Find nested group memberships.' },
			foreignMembers: { query: `MATCH (u)-[:MemberOf]->(g:Group)\nWHERE NOT u.domain = g.domain\nRETURN u.name, g.name`, desc: 'Find foreign domain members in groups.' },
			highValueGroups: { query: `MATCH (g:Group)\nWHERE g.highvalue = true\nRETURN g.name`, desc: 'List all high-value groups.' },
			adminGroups: { query: `MATCH (g:Group)\nWHERE g.name =~ "(?i).*(ADMIN|OPERATOR).*"\nRETURN g.name`, desc: 'Find all administrative groups.' },
			groupsCanRDP: { query: `MATCH (g:Group)-[:CanRDP]->(c:Computer)\nRETURN g.name, collect(c.name)`, desc: 'Find groups with RDP access to computers.' },
			allComputers: { query: `MATCH (c:Computer)\nRETURN c.name, c.operatingsystem, c.enabled`, desc: 'List all computers with OS and status.' },
			domainControllers: { query: `MATCH (c:Computer)\nWHERE c.name =~ "(?i).*DC.*" OR c.unconstraineddelegation = true\nRETURN c.name, c.operatingsystem`, desc: 'Find Domain Controllers.' },
			lapsComputers: { query: `MATCH (c:Computer)\nWHERE c.haslaps = true\nRETURN c.name`, desc: 'Find computers with LAPS enabled.' },
			noLaps: { query: `MATCH (c:Computer)\nWHERE c.haslaps = false OR c.haslaps IS NULL\nRETURN c.name`, desc: 'Find computers without LAPS.' },
			windows10: { query: `MATCH (c:Computer)\nWHERE c.operatingsystem =~ "(?i).*Windows 10.*"\nRETURN c.name, c.operatingsystem`, desc: 'Find Windows 10 computers.' },
			windows11: { query: `MATCH (c:Computer)\nWHERE c.operatingsystem =~ "(?i).*Windows 11.*"\nRETURN c.name, c.operatingsystem`, desc: 'Find Windows 11 computers.' },
			server2019: { query: `MATCH (c:Computer)\nWHERE c.operatingsystem =~ "(?i).*Server 2019.*"\nRETURN c.name, c.operatingsystem`, desc: 'Find Windows Server 2019.' },
			server2022: { query: `MATCH (c:Computer)\nWHERE c.operatingsystem =~ "(?i).*Server 2022.*"\nRETURN c.name, c.operatingsystem`, desc: 'Find Windows Server 2022.' },
			unsupportedOS: { query: `MATCH (c:Computer)\nWHERE c.operatingsystem =~ "(?i).*(2008|2003|XP|Vista|Windows 7).*"\nRETURN c.name, c.operatingsystem`, desc: 'Find computers with unsupported OS.' },
			compWithSessions: { query: `MATCH (c:Computer)-[:HasSession]->(u:User)\nRETURN c.name, count(u) as sessionCount\nORDER BY sessionCount DESC`, desc: 'Computers ordered by session count.' },
			allUsers: { query: `MATCH (u:User)\nRETURN u.name, u.enabled, u.lastlogon`, desc: 'List all users.' },
			enabledUsers: { query: `MATCH (u:User)\nWHERE u.enabled = true\nRETURN u.name`, desc: 'List enabled users only.' },
			disabledUsers: { query: `MATCH (u:User)\nWHERE u.enabled = false\nRETURN u.name`, desc: 'List disabled users.' },
			highValueUsers: { query: `MATCH (u:User)\nWHERE u.highvalue = true\nRETURN u.name`, desc: 'List high-value users.' },
			adminCount: { query: `MATCH (u:User)\nWHERE u.admincount = true\nRETURN u.name`, desc: 'Find users with adminCount=1.' },
			passNotReq: { query: `MATCH (u:User)\nWHERE u.passwordnotreqd = true\nAND u.enabled = true\nRETURN u.name`, desc: 'Find users where password is not required.' },
			passNeverExp: { query: `MATCH (u:User)\nWHERE u.pwdneverexpires = true\nAND u.enabled = true\nRETURN u.name`, desc: 'Find users with password never expires.' },
			ownedUsers: { query: `MATCH (u:User)\nWHERE u.owned = true\nRETURN u.name`, desc: 'List all owned users.' },
			sensitiveUsers: { query: `MATCH (u:User)\nWHERE u.sensitive = true\nRETURN u.name`, desc: 'Find users marked as sensitive.' },
			allGPOs: { query: `MATCH (g:GPO)\nRETURN g.name, g.gpcpath`, desc: 'List all GPOs.' },
			gpoOnDA: { query: `MATCH p=(g:GPO)-[:GpLink]->(o:OU)-[:Contains*1..]->(u:User)-[:MemberOf*1..]->(da:Group)\nWHERE da.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN p`, desc: 'Find GPOs that affect Domain Admins.' },
			gpoOnDC: { query: `MATCH p=(g:GPO)-[:GpLink]->(o:OU)-[:Contains*1..]->(c:Computer)\nWHERE c.name =~ "(?i).*DC.*"\nRETURN p`, desc: 'Find GPOs affecting Domain Controllers.' },
			gpoControllers: { query: `MATCH p=(n)-[:GenericAll|GenericWrite|WriteOwner|WriteDacl]->(g:GPO)\nRETURN p`, desc: 'Find who can modify GPOs.' },
			gpoToComputer: { query: `MATCH p=(g:GPO)-[:GpLink]->(o:OU)-[:Contains*1..]->(c:Computer {name:"COMPUTER.DOMAIN.COM"})\nRETURN p`, desc: 'Find GPOs affecting specific computer.' },
			allDomains: { query: `MATCH (d:Domain)\nRETURN d.name, d.functionallevel`, desc: 'List all domains.' },
			domainTrusts: { query: `MATCH p=(d1:Domain)-[:TrustedBy]->(d2:Domain)\nRETURN p`, desc: 'Find domain trust relationships.' },
			foreignGroups: { query: `MATCH (u)-[:MemberOf]->(g:Group)\nWHERE u.domain <> g.domain\nRETURN u.name, u.domain, g.name, g.domain`, desc: 'Find cross-domain group memberships.' },
			crossDomainPaths: { query: `MATCH p=shortestPath((n {domain:"DOMAIN1.COM"})-[*1..]->(m {domain:"DOMAIN2.COM"}))\nRETURN p`, desc: 'Find attack paths across domains.' },
			sidHistory: { query: `MATCH (u:User)\nWHERE u.sidhistory IS NOT NULL\nRETURN u.name, u.sidhistory`, desc: 'Find users with SID History.' },
			nodeCount: { query: `MATCH (n)\nRETURN labels(n)[0] as NodeType, count(n) as Count\nORDER BY Count DESC`, desc: 'Count nodes by type.' },
			edgeCount: { query: `MATCH ()-[r]->()\nRETURN type(r) as EdgeType, count(r) as Count\nORDER BY Count DESC`, desc: 'Count edges by type.' },
			daCount: { query: `MATCH (u:User)-[:MemberOf*1..]->(g:Group)\nWHERE g.name =~ "(?i).*DOMAIN ADMINS.*"\nRETURN count(DISTINCT u)`, desc: 'Count total Domain Admins.' },
			computerOS: { query: `MATCH (c:Computer)\nRETURN c.operatingsystem as OS, count(c) as Count\nORDER BY Count DESC`, desc: 'Count computers by operating system.' },
			usersPerGroup: { query: `MATCH (u:User)-[:MemberOf]->(g:Group)\nRETURN g.name, count(u) as MemberCount\nORDER BY MemberCount DESC\nLIMIT 25`, desc: 'Top 25 groups by member count.' }
		};

		function setPreset(presetName) {
			currentPreset = presetName;
			const preset = presets[presetName];
			let query = preset.query;
			const domain = document.getElementById('domainName').value || 'DOMAIN.COM';
			query = query.replace(/DOMAIN\.COM/g, domain);
			const target = document.getElementById('targetNode').value;
			if (target) {
				query = query.replace(/TARGET@DOMAIN\.COM/g, target);
				query = query.replace(/TARGET/g, target.split('@')[0]);
			}
			document.getElementById('cypherQuery').textContent = query;
			document.getElementById('queryDescription').innerHTML = `<strong>${presetName}:</strong> ${preset.desc}`;
			document.querySelectorAll('.preset-btn').forEach(btn => btn.classList.remove('active'));
			event.target.classList.add('active');
		}

		function regenerateQuery() {
			if (currentPreset && presets[currentPreset]) {
				const preset = presets[currentPreset];
				let query = preset.query;
				const domain = document.getElementById('domainName').value || 'DOMAIN.COM';
				query = query.replace(/DOMAIN\.COM/g, domain);
				const target = document.getElementById('targetNode').value;
				if (target) {
					query = query.replace(/TARGET@DOMAIN\.COM/g, target);
					query = query.replace(/TARGET/g, target.split('@')[0]);
				}
				document.getElementById('cypherQuery').textContent = query;
			}
		}

		function buildCustomQuery() {
			const nodeType = document.getElementById('customNodeType').value;
			const edgeType = document.getElementById('customEdgeType').value;
			const targetType = document.getElementById('customTargetType').value;
			const targetName = document.getElementById('customTargetName').value;
			const domain = document.getElementById('domainName').value || 'DOMAIN.COM';
			let edge = edgeType ? `[:${edgeType}]` : '[*1..]';
			let query = targetName
				? `MATCH p=(n:${nodeType})-${edge}->(m:${targetType})\nWHERE m.name =~ "(?i).*${targetName}.*@${domain}"\nRETURN p`
				: `MATCH p=(n:${nodeType})-${edge}->(m:${targetType})\nRETURN p\nLIMIT 100`;
			document.getElementById('cypherQuery').textContent = query;
			document.getElementById('queryDescription').innerHTML = `<strong>Custom:</strong> Find ${nodeType} with ${edgeType || 'any'} relationship to ${targetType}${targetName ? ' named ' + targetName : ''}.`;
		}

		function copyQuery() {
			const query = document.getElementById('cypherQuery').textContent;
			navigator.clipboard.writeText(query).then(() => {
				const btn = document.querySelector('.copy-btn');
				btn.innerHTML = '<i class="fas fa-check"></i> Copied';
				setTimeout(() => { btn.innerHTML = '<i class="fas fa-copy"></i> Copy'; }, 2000);
			});
		}
	</script>
</body>
</html>
